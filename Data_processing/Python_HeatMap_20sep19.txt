# To create Heat Maps in Python

import numpy as np
import matplotlib.pyplot as plt

############################################################################################
#                                Model                                                     #
############################################################################################
    
 # Conditions of particles: density and size 
densidad = ["6","12","18","24","30","36","42","48","54","60","0"]
tamaño = ["0","3","6","9","12","18","24","30","36","42","48"]

 # Average proportion of aggregate cells
neigh= [[0.921,0.897571429,0.877428571,0.923714286,0.932,0.947428571,0.941428571,0.946714286,0.921,0.921,0.921],
        [0.921,0.906857143,0.902142857,0.873714286,0.930285714,0.927,0.939714286,0.954,0.953857143,0.946714286,0.966571429],
        [0.921,0.919285714,0.909142857,0.909,0.922857143,0.935571429,0.940714286,0.951428571,0.963285714,0.956285714,0.965857143],
        [0.921,0.912857143,0.916857143,0.913571429,0.931857143,0.94,0.939714286,0.941714286,0.948,0.962285714,0.964857143],
        [0.921,0.915,0.910857143,0.919142857,0.926857143,0.933142857,0.933571429,0.942428571,0.943857143,0.954,0.954857143],
        [0.921,0.912,0.917,0.920714286,0.928285714,0.925714286,0.938571429,0.936,0.950142857,0.948142857,0.947857143],
        [0.921,0.923,0.912,0.917571429,0.921285714,0.928,0.936428571,0.939285714,0.939571429,0.948714286,0.951],
        [0.921,0.918571429,0.911142857,0.910428571,0.921571429,0.927857143,0.929571429,0.943,0.935714286,0.944142857,0.943857143],
        [0.921,0.912857143,0.914571429,0.919571429,0.925857143,0.925428571,0.929714286,0.935714286,0.937,0.941714286,0.946285714],
        [0.921,0.915428571,0.910428571,0.923285714,0.922428571,0.923857143,0.921428571,0.930428571,0.932428571,0.94,0.943714286],
        [0.921,0.921,0.921,0.921,0.921,0.921,0.921,0.921,0.921,0.921,0.921]]

 # Average number of aggregates
num= [[129.6,144.1,146.8,141.3,124.9,103.9,76.6,53.2,129.6,129.6,129.6],      
      [129.6,133.9,133.1,125.2,109.4,118.1,114,92.2,85.1,35.2,59.6],
      [129.6,135.5,130.6,131.9,131.5,118.8,104.9,102.5,86.3,78.8,66.2],
      [129.6,132.6,134.7,129.4,130.3,121.9,111.8,103.7,94.7,76.3,78.7],
      [129.6,127.8,134.9,131.8,126,120.7,113.2,106.6,96.2,90.4,84.1],
      [129.6,132,132.5,131,126.7,119.6,115.7,108,101.9,97.1,78.9],
      [129.6,131.4,131,126.7,130.1,123.5,119,115.8,104.2,96.5,96.9],
      [129.6,130.1,126.3,128.3,122.8,128.1,121,116.6,107.4,107.5,102.2],
      [129.6,130.1,128.3,127.4,129.9,125.7,122.4,117.7,112.5,111.1,103.6],
      [129.6,130.7,131.4,131.8,126,125.4,120.4,119.1,116.6,111.4,103.7],
      [129.6,129.6,129.6,129.6,129.6,129.6,129.6,129.6,129.6,129.6,129.6]]

 # Average size of aggregates
tam= [[17.26,14.5,13.5,13.36,13.9,16.52,21.42,34.26,17.26,17.2,17.26],
      [17.26,16.26,15.32,15.16,17.1,17.76,19.2,22.56,26.2,48.94,35.68],
      [17.26,17.92, 20.02, 17.3, 16.78, 18.9, 21.16, 22.48, 27.46,31.42,34.82],
      [17.26,16.72,16.44,16.86,17.02,17.8,20.5,22.58,25.68,30.18,30.24],
      [17.26,16.76,16.76,19.48,21.18,18.94,20.52,21.26,26.34,24.92,28.26],
      [17.26,16.88,16.54,16.66,17.8,18.56,18.78,20.62,23.28,25.02,30.58],
      [17.26,16.46,16.46,16.44,17.28,17.7,18.94,18.7,22.64,24.82,24.18],
      [17.26,16.2,17.5,16.7,17.32,16.98,18.24,19.8,22.5,22,24.16],
      [17.26,17.72,17.64,17.68,17.96,18.06,18.54,20.32,20.12,20.58,22.18],
      [17.26,16.2,17.7,16.64,19.2,18.18,18.14,19.62,20.28,20.9,23.56],                  
      [17.26,17.26,17.26,17.26,17.26,17.26,17.26,17.26,17.26,17.26,17.26]]

# Standard deviation of proportion of aggregate cells
nesd= [[0.009308275,0.011601861,0.009740394,0.00797388,0.007493005,0.01047619,0.007439857,0.007439857,0.007439857,0.007439857],
[0.01128481,0.012013786,0.015270798,0.007731316,0.009699569,0.004752371,0.008645185,0.006425925,0.007409316,0.005093235],
[0.013952462,0.013967893,0.012760661,0.010011331,0.009815763,0.009458107,0.008357109,0.008194075,0.008576718,0.006188644],
[0.016413036,0.00920416,0.00636209,0.008730014,0.008624176,0.007990925,0.007553288,0.007772269,0.009576047,0.004723656],
[0.006397633,0.007830402,0.007101467,0.007789754,0.006727613,0.010218697,0.007191895,0.009429293,0.010450184,0.007383256],
[0.006707359,0.010826398,0.009410035,0.005824337,0.008934125,0.009282661,0.006015852,0.008817885,0.010754949,0.010653265],
[0.011217293,0.012218717,0.009210317,0.011692391,0.007133327,0.006397633,0.011571527,0.00875595,0.008609703,0.009898579],
[0.006494372,0.009253301,0.013111246,0.006225177,0.010107136,0.00992146,0.008093837,0.006700594,0.012148925,0.008519685],
[0.012670604,0.01433009,0.008519685,0.010442587,0.009447312,0.010579576,0.013041013,0.008843564,0.007493005,0.011531284],
[0.013798025,0.005834062,0.006869367,0.009185664,0.010838957,0.006023386,0.010477273,0.010649007,0.008024905,0.004426267]]

# Standard deviation of number of aggregates
nusd= [[6.714908786,7.560423269,2.722131518,3.419064199,2.467792536,1.624807681,4.915282291,4.915282291,4.915282291,4.915282291],
[6.441273166,5.838664231,5.810335619,5.295280918,4.592385001,6.32455532,5.670978752,3.986226286,2.891366459,4.127953488],
[6.652067348,7.683749085,5.7,7.088723439,5.509990926,4.846648326,6.375735252,3.287856445,5.173006863,5.54616985],
[5.238320341,3.97617907,6.452906322,5.916924877,4.928488612,7.152621897,3.97617907,6.116371473,4.337049688,4.9],
[6.95413546,4.825971405,5.528109984,6.066300355,5.745432969,7.359347797,5.499090834,6.808817812,3.826225294,7.647875522],
[7.848566748,6.800735254,6.371812929,6.213694553,4.862098312,9.044888059,6.212889827,4.784349486,3.832753579,7.777531742],
[6.575712889,5.138093031,5.060632372,6.3,7.645259969,5.899152482,3.841874542,6.6,3.324154028,7.968061245],
[8.190848552,7.823681998,5.745432969,8.829496022,6.090155991,5.656854249,4.862098312,4.004996879,8.663140308,7.807688518],
[5.146843693,5.292447449,5.16139516,7.063285355,5.848931526,5.986651819,5.060632372,7.433034374,5.485435261,7.186097689],
[4.450842617,6.590902821,6.368673331,7.197221686,7.405403433,4.882622246,7.091544261,4.45421149,5.642694392,6.827151675]]

# Standard deviation of size of aggregates
tasd= [[3.119294792,2.787471973,2.951338679,3.459768778,2.765791026,3.878607998,12.36254019,12.36254019,12.36254019,12.36254019],
[2.755431001,2.98288451,3.015692292,2.851315486,4.632752961,4.436214603,3.424383156,5.173006863,12.4103344,10.16944443],
[4.886061809,3.936953137,4.011234224,4.759369706,4.661544808,4.360550424,5.647087745,5.532485879,7.381300698,8.267260731],
[3.04,4.596346375,3.280304864,4.244949941,3.364520768,4.428317965,5.299396192,7.046814883,10.21310922,8.247569339],
[4.135504806,4.067234933,4.239056499,3.718548104,4.429040528,4.504397851,4.799208268,8.21367153,6.349299174,7.163267411],
[3.669550381,3.528229018,2.957093167,4.079215611,5.068175214,4.993155315,5.328752199,6.26750349,6.792613635,7.82071608],
[3.556458913,2.836970215,3.544911847,3.779100422,3.97617907,3.40241091,2.787471973,5.335766112,6.275954111,6.784364377],
[3.280243893,4.031128874,3.257299495,3.177672104,4.057043258,4.11125285,4.99199359,5.154609588,6.003332408,5.686334496],
[5.028081145,3.97874352,3.931615444,4.331096859,4.379086663,4.011034779,5.964696136,5.128898517,5.3706238,3.866212617],
[4.049691346,4.450842617,2.733203249,3.954743987,3.819371676,3.773645452,5.011546667,4.919512171,6.591661399,8.050242232]]



############################################################################################
#                                Model Robustness                                          #
############################################################################################

 # Conditions of particles: density and size 
cdensidad = ["6","24","42","60","0"]
ctamaño = ["0","3","12","30","48"]


         ##### Compact Cells #####

 # Average proportion of aggregate cells
Cne= [[0.944428571,0.927857143,0.922714286,0.954,0.974142857],
[0.944428571,0.942857143,0.944142857,0.957857143,0.967571429],
[0.944428571,0.947571429,0.944142857,0.951428571,0.956714286],
[0.944428571,0.944428571,0.936142857,0.956,0.957428571],
[0.944428571,0.944428571,0.944428571,0.944428571,0.944428571]]

 # Average number of aggregates
Cnu= [[135.2,163.4,152.2,120.8,91.8],
[135.2,134.8,132.3,116.3,93.3],
[135.2,136.8,135.6,126.9,114.4],
[135.2,136.7,130.8,127.7,115.6],
[135.2,135.2,135.2,135.2,135.2]]

 # Average size of aggregates
Cta= [[14.82,10.72,11.78,17.8,22.5],
[14.82,13.58,15.62,16.66,21.78],
[14.82,14.64,14.6,16.72,18.52],
[14.82,14.92,15.62,16.52,17.64],
[14.82,14.82,14.82,14.82,14.82]]


         ##### Elongated Cells #####

 # Average proportion of aggregate cells
Lne= [[0.921,0.897571429,0.932,0.946714286,0.966571429],
[0.921,0.912857143,0.931857143,0.941714286,0.964857143],
[0.921,0.923,0.921285714,0.939285714,0.951],
[0.921,0.915428571,0.922428571,0.930428571,0.943714286],
[0.921,0.921,0.921,0.921,0.921]]

 # Average number of aggregates
Lnu= [[129.6,144.1,124.9,53.2,59.6],      
[129.6,132.6,130.3,103.7,78.7],
[129.6,131.4,130.1,115.8,96.9],
[129.6,130.7,126,119.1,103.7],
[129.6,129.6,129.6,129.6,129.6]]

 # Average size of aggregates
Lta= [[17.26,14.5,13.9,34.26,17.26],
[17.26,16.72,17.02,22.58,30.24],
[17.26,16.46,17.28,18.7,24.18],
[17.26,16.2,19.2,19.62,23.56],                  
[17.26,17.26,17.26,17.26,17.26,]]



###################################################
#                    Matrix                       #
###################################################

   ### Model ###
Ne= np.array(neigh)
Nu= np.array(num)
Ta= np.array(tam)

### Standard deviation ###
ne= np.array(nesd)
nu= np.array(nusd)
ta= np.array(tasd)

### Compact cells ###
Cne= np.array(Cne)
Cnu= np.array(Cnu)
Cta= np.array(Cta)

### Elongated cells ###
Lne= np.array(Cne)
Lnu= np.array(Cnu)
Lta= np.array(Cta)



###################################################
#                 Heat Map Plot                   #
###################################################

fig, ax = plt.subplots()
plt.imshow(Ne);

ax.set_xticks(np.arange(len(tamaño)))
ax.set_yticks(np.arange(len(densidad)))
ax.set_xticklabels(tamaño)
ax.set_yticklabels(densidad)
ax.set_title("")
plt.ylabel('Densidad de obstáculos (1/N)')
plt.xlabel('Tamaño de obstáculos')

cb=plt.colorbar()
#plt.clim(12,34)
cb.set_label('Proporción de células agregadas')
plt.show()